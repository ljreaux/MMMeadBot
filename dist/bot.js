"use strict";var P=Object.create;var M=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var q=Object.getOwnPropertyNames;var G=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var Q=(e,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of q(n))!Y.call(e,o)&&o!==t&&M(e,o,{get:()=>n[o],enumerable:!(r=U(n,o))||r.enumerable});return e};var c=(e,n,t)=>(t=e!=null?P(G(e)):{},Q(n||!e||!e.__esModule?M(t,"default",{value:e,enumerable:!0}):t,e));var m=require("discord.js"),S=c(require("dotenv"));var f=[{name:"eightminutemead",link:"https://youtu.be/nA7tLIFcgts"},{name:"meadmistakes",link:"https://youtu.be/rCN-TSSsRmc"},{name:"yeasttest",link:"https://youtu.be/-_shVjrZIO4"},{name:"applecinnamon",link:"https://youtu.be/NF1dhaeysB0"},{name:"bottlecarbonation",link:"https://youtu.be/ipPIbB8tS0M"},{name:"sweetmead",link:"https://youtu.be/sOpBxyrANlQ"},{name:"hoppedblueberry",link:"https://youtu.be/dzUa_K-iRCY"},{name:"carbonatedblueberry",link:"https://youtu.be/yAwLpol-G6A"},{name:"allstyles",link:"https://youtu.be/08eQ-ylpvKk"},{name:"discordmead1",link:"https://youtu.be/K78YNSn5sd8"},{name:"discordmead2",link:"https://youtu.be/21OMY2OMmFg"},{name:"discordmead3",link:" https://youtu.be/v0PnWMp0COw"},{name:"discordmead4",link:"https://youtu.be/ZHfCwTogiqo"},{name:"discordmead5",link:"https://youtu.be/wrL0TTeRu0w"},{name:"discordmead6",link:"https://youtu.be/RqouA9Fl01s"},{name:"discordmead7",link:"https://youtu.be/90HIPS_dnEM"},{name:"discordmead8",link:"https://youtu.be/Todjm7wGbPU"},{name:"brewsysucks",link:"https://youtu.be/2m-EmXL8QOo"},{name:"peppermintmead",link:"https://youtu.be/6T7BdYta4YQ"},{name:"mixedberrymead",link:"https://youtu.be/0J-p54wh1tI"},{name:"rootbeermead",link:"https://youtu.be/UGuJgqhMwxU"},{name:"teamead",link:"https://youtu.be/3Npbhc7Jp1k"},{name:"pinacolada",link:"https://youtu.be/INJ-bxrRCBE"},{name:"redpyment",link:"https://youtu.be/jESTDN9eqhU"},{name:"meadmakingprocess",link:" https://youtu.be/NQmhIQXnnNg"},{name:"whitepyment",link:"https://youtu.be/JXit06hwAZY"},{name:"punishingyeast",link:"https://youtu.be/CsMJmDdQ-_o"},{name:"dndmead",link:"https://youtu.be/GsHlL_Suw4M"},{name:"hothoney",link:"https://youtu.be/cBZXGCQFX8I"},{name:"meadsquidgame",link:"https://youtu.be/gGD9OuZtILc"},{name:"cucumberlime",link:"https://youtu.be/hnT3RXN9v-Q"}],C=(e,n)=>{let[,t]=e.split(" "),r=t?.toLowerCase()||"",o=f.find(s=>s.name===r);if(o){n.channel.send(o.link);return}else if(t){n.channel.send(`The recipe ${t} is not a valid recipe command.`);return}};var p=c(require("mongoose")),D=new p.default.Schema({command:{type:String,required:!0},response:{type:String,required:!0}}),w=p.default.models.Command||p.default.model("Command",D);var _=["Beginner","10 Meads","20 Meads","25 Meads","30 Meads","40 Meads","50 Meads","75 Meads","100 Meads"],oe=_.reduce((e,n)=>`${e}
- ${n}`),te=f.map(e=>e.name).reduce((e,n)=>`${e}
- ${n}`),F=async()=>await w.find(),h="?rank ",v=e=>{let n=!1;return["Administrator","Moderator","Mazer of the Week","Patreon Bot","Discord Mead Leader","MMM Patron","Mead Bot","Rythm","Server Booster","EasyPoll","Live Countdown Bot","YouTube Member","technician","YouTube","YT Bot","UMM2024","UMM 2024 Purgatory Member"].forEach(r=>{(r.toLowerCase()===e.toLowerCase()||r.toLowerCase().includes(e.toLowerCase()))&&(n=!0)}),n},R=async(e,n)=>{let t=await F();for(let o of t)(o.command===e||e.includes(o.command))&&n.channel.send(o.response).catch(s=>console.error(s));let r=o=>{let s=[];return s=o.map(a=>`${a.command}
`),s};if(e=="!list"){let o=`
**Available Bot Commands**
`,s=r(t),d=`${o}${s}`.replaceAll(",","");n.channel.send(d).catch(u=>console.error(u))}};var J=e=>-668.962+1262.45*e-776.43*e**2+182.94*e**3,X=(e,n)=>{let t=-668.962+1262.45*e-776.43*e**2+182.94*e**3,r=-668.962+1262.45*n-776.43*n**2+182.94*n**3,o=.22+.001*t,s=(o*t+r)/(1+o),a=(t-s)/(2.0665-.010665*t),d=Math.round(a*(n/.794)*100)/100;return[Math.round(J(n)+4.5*d),d]},L=(e,n)=>{let[,t,r]=e.split(" "),[o,s]=[Number(t),Number(r)||.996];if(isNaN(o)||isNaN(s)||o<s||o>1.22||s>1.22||o-s>.165){n.channel.send("Please enter a valid number for OG and FG. Example: !abv 1.050 1.010");return}let[d,u]=X(o,s);n.channel.send(`An OG of ${o} and an FG of ${s} will make ${u}% ABV and ${d} delle units.`)};var y=require("discord.js"),x=(e,n)=>{let t=n.includes("kick")?"kick":"ban";if(!(e.member?.permissionsIn(e.channel.id).has(y.PermissionsBitField.Flags.Administrator)||e.member?.permissionsIn(e.channel.id).has(y.PermissionsBitField.Flags.ModerateMembers))){e.channel.send("Nice try, but you don't have the power");return}let[,r]=n.split(" ");if(!r){e.channel.send(`You need to specify a user to ${t}.`);return}let o=e.mentions.users.first();if(!o){e.channel.send("User not found.");return}t==="kick"?e.guild?.members.kick(o):e.guild?.members.ban(o),e.channel.send(`${o.tag} has been ${t}ed.`)};var B=(e,n,t)=>{let r=t?.roles.cache.filter(a=>a.name.toLowerCase().includes("mead")||a.name.toLowerCase()==="beginner"),o=e.substring(h.length);if(v(o)){n.channel.send(`You are in this discord server, but we do not grant you the rank of ${o}`);return}let s=n.guild?.roles.cache.find(a=>(o==="10"&&(o="10 "),a.name.toLowerCase()===o.toLowerCase()||a.name.toLowerCase().includes(o.toLowerCase())));if(!s){n.channel.send(`The role ${o} is not a valid role.`);return}r?.forEach(a=>t?.roles.remove(a.id)),t?.roles.add(s.id),n.channel.send(`You have been assigned to role "${s.name}"`).catch(a=>console.error(a))};var k=c(require("express")),I=c(require("cors")),E=c(require("body-parser"));var $=c(require("mongoose")),T=c(require("dotenv"));T.default.config();var A=process.env.MONGO_URI,i=global.mongoose;async function j(){if(!A)throw new Error("Please define the MONGODB_URI environment variable inside .env.local");if(i||(i=global.mongoose={conn:null,promise:null}),i.conn)return i.conn;if(!i.promise){let e={bufferCommands:!1};i.promise=$.default.connect(A,e).then(n=>(console.log("Db connected"),n))}try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}var N=j;S.default.config();var{token:z,welcomeChannel:W="",botSpamChannel:Z=""}=process.env,l=new m.Client({intents:[m.GatewayIntentBits.Guilds,m.GatewayIntentBits.GuildMessages,m.GatewayIntentBits.MessageContent,m.GatewayIntentBits.GuildMembers,m.GatewayIntentBits.GuildPresences]});l.login(z);l.once(m.Events.ClientReady,e=>{console.log(`Ready! Logged in as ${e.user.tag}`)});l.on("messageCreate",e=>{if(e.author.bot)return;let n=e.content,{member:t}=e,r=o=>n.toLowerCase().startsWith(o);return r("?kick")||r("?ban")?x(e,n):r(h)?B(n,e,t):r("!recipes")?C(n,e):r("!abv")?L(n,e):R(n,e)});l.on("guildMemberAdd",e=>{l.channels.cache.get(W).send(`Welcome to the MMM Discord Server <@${e.user.id}>!

 Please head over to <#${Z}> and run **?rank (rank)** to recieve a rank and join your mini mead making community.

Run **!recipes** to get a list of popular MMM recipes.

You can find a list of all commands by running **!list**`)});var g=k.default.Router(),{PORT:O=8080}=process.env,b=(0,k.default)();b.use((0,I.default)());b.use(E.default.json({limit:"50mb"}));b.use("/",g);b.listen(O,async()=>{try{await N(),console.log(`Server running on port ${O}`)}catch(e){console.log(e)}});g.get("/",(e,n)=>{try{n.send({message:"Server running"})}catch{n.send({message:"An error occurred"})}});g.post("",(e,n)=>{try{n.send({message:"Command List has been updated."})}catch{n.send({message:"An error occurred"})}});
